<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã‚¯ãƒªãƒƒã‚¯èª˜ç™ºç‡ã‚¹ã‚³ã‚¢ãƒ©ãƒ¼</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet"/>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'DM Sans', 'Noto Sans JP', sans-serif; }
    @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
    @keyframes petalFall {
      0% { transform: translateY(-30px) translateX(0px) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(105vh) translateX(80px) rotate(720deg); opacity: 0; }
    }
    input::placeholder { color: #e8b8cc; }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useRef, useCallback, useEffect } = React;

    /* â”€â”€ èŠ±ã³ã‚‰ â”€â”€ */
    function FallingPetals() {
      const [petals, setPetals] = useState([]);
      useEffect(() => {
        setPetals(Array.from({ length: 18 }, (_, i) => ({
          id: i, left: Math.random()*100, delay: Math.random()*12,
          duration: 10+Math.random()*14, size: 12+Math.random()*16,
          opacity: 0.25+Math.random()*0.4, rotation: Math.random()*360,
          type: Math.floor(Math.random()*3),
        })));
      }, []);
      return (
        <div style={{position:"fixed",inset:0,pointerEvents:"none",zIndex:0,overflow:"hidden"}}>
          {petals.map(p=>(
            <div key={p.id} style={{position:"absolute",left:`${p.left}%`,top:"-30px",width:p.size,height:p.size,opacity:p.opacity,animation:`petalFall ${p.duration}s ${p.delay}s linear infinite`,transform:`rotate(${p.rotation}deg)`}}>
              <svg viewBox="0 0 20 20" width={p.size} height={p.size}>
                {p.type===0&&<ellipse cx="10" cy="10" rx="8" ry="5" fill="#fab0d6" transform={`rotate(${p.rotation},10,10)`} opacity="0.8"/>}
                {p.type===1&&<path d="M10 2 C14 6,18 10,10 18 C2 10,6 6,10 2Z" fill="#fcc5e2" opacity="0.7"/>}
                {p.type===2&&<ellipse cx="10" cy="10" rx="6" ry="9" fill="#fddaec" transform={`rotate(${30+p.rotation},10,10)`} opacity="0.6"/>}
              </svg>
            </div>
          ))}
        </div>
      );
    }

    /* â”€â”€ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ â”€â”€ */
    const SYSTEM_PROMPT_IMAGE = `ã‚ãªãŸã¯SmartNewsé…ä¿¡å‘ã‘Webè¨˜äº‹ã®çœ‹æ¿ç”»åƒï¼ˆã‚¢ã‚¤ã‚­ãƒ£ãƒƒãƒç”»åƒï¼‰ã‚’åˆ†æã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚
GLOï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒ©ã‚¤ãƒ•ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰ã¨ã„ã†ã‚·ãƒ‹ã‚¢å‘ã‘Webãƒ¡ãƒ‡ã‚£ã‚¢ã®çœ‹æ¿ç”»åƒã‚’ã€SmartNewsã§ã®ã‚¯ãƒªãƒƒã‚¯ç‡æœ€å¤§åŒ–ã®è¦³ç‚¹ã§æ¡ç‚¹ã—ã¦ãã ã•ã„ã€‚

ã€æœ€é‡è¦ã€‘SmartNewsçœ‹æ¿ç”»åƒã®é‰„å‰‡ï¼ˆç¤¾å†…ãƒã‚¦ãƒã‚¦ï¼‰ï¼š
1. ãƒ‘ãƒƒã¨è¦‹ã¦ç›®ã‚’å¼•ãç”»åƒã§ã‚ã‚‹ã“ã¨ï¼ˆãƒ•ã‚£ãƒ¼ãƒ‰ä¸Šã§åŸ‹ã‚‚ã‚Œãªã„ã“ã¨ï¼‰
2. ãƒ‘ãƒƒã¨è¦‹ã¦ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ã‹åˆ†ã‹ã‚‹æ§‹å›³ã§ã‚ã‚‹ã“ã¨
3. äººç‰©åŒå£«ã®é–¢ä¿‚æ€§ã‚„ã€è¡¨æƒ…ã‚’å¤§äº‹ã«ã™ã‚‹ã“ã¨ï¼ˆè¡¨æƒ…ãŒåˆ†ã‹ã‚‹äººé–“ã®é¡”ãŒã‚ã‚‹ã‹ï¼‰
4. é‡è¦ãªè¦ç´ ã¯ãªã‚‹ã¹ãä¸­å¿ƒã«é…ç½®ã™ã‚‹ã“ã¨ï¼ˆSmartNewsã¯ä¸¡ã‚µã‚¤ãƒ‰ãŒå‰Šã‚Œã‚‹ãŸã‚ï¼‰
5. æ›–æ˜§ãªç”»åƒã¯ãªã‚‹ã¹ãé¿ã‘ã‚‹ã“ã¨ï¼ˆç›®ã‚’å¼•ã‹ãªã„ã€åŸ‹ã‚‚ã‚Œã‚‹ï¼‰

ã€åŠ ç‚¹è¦ç´ ã€‘ï¼š
- è¡¨æƒ…ãŒåˆ†ã‹ã‚‹äººé–“ã®é¡”ãŒå…¥ã£ã¦ã„ã‚‹
- ã‚¿ã‚¤ãƒˆãƒ«ã«å…¥ã‚Šãã‚‰ãªã‹ã£ãŸæƒ…å ±ã‚’ç”»åƒã§è£œå®Œã—ã¦ã„ã‚‹
- å®˜èƒ½çš„ãƒ»ç·Šå¼µæ„Ÿã®ã‚ã‚‹é›°å›²æ°—ã®æ¼”å‡ºãŒã‚ã‚‹
- Canvaç­‰ã§ã®ç”»åƒç·¨é›†ã§é›°å›²æ°—ã‚’å¼·åŒ–ã—ã¦ã„ã‚‹ï¼ˆãŸã ã—æš—ã™ãã¯NGï¼‰
- ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’å¼·ãã—ã¦å·®åˆ¥åŒ–ãƒ»ç·Šå¼µæ„Ÿãƒ»ãƒ€ãƒ¼ã‚¯ãªé›°å›²æ°—ã‚’å‡ºã—ã¦ã„ã‚‹
- äººç‰©ã®æ„Ÿæƒ…ï¼ˆææ€–ã€æ‚²ã—ã¿ã€æ€’ã‚Šã€åˆ‡ãªã•ç­‰ï¼‰ãŒã¯ã£ãã‚Šä¼ã‚ã‚‹

ã€æ¸›ç‚¹è¦ç´ ã€‘ï¼š
- é‡è¦è¦ç´ ãŒä¸¡ã‚µã‚¤ãƒ‰ã«å¯„ã£ã¦ã„ã‚‹ï¼ˆSNã§è¦‹åˆ‡ã‚Œã‚‹ï¼‰
- è¡¨æƒ…ãŒèª­ã¿å–ã‚Œãªã„/äººç‰©ã®é¡”ãŒå°ã•ã„
- ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ä¸€ç›®ã§ã‚ã‹ã‚‰ãªã„
- ä»–ã®è¨˜äº‹ã¨å·®åˆ¥åŒ–ã§ããªã„å¹³å‡¡ãªæ§‹å›³
- æš—ã™ãã¦ä½•ãŒå†™ã£ã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã„

ã€é‡è¦ãƒ«ãƒ¼ãƒ«ã€‘ï¼š
- å½“ç¤¾ã§ã¯çœ‹æ¿ç”»åƒå†…ã«ãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ–‡å­—ï¼‰ã‚’å…¥ã‚Œã‚‹ã“ã¨ã¯ç¦æ­¢ã—ã¦ã„ã¾ã™ã€‚ç”»åƒå†…ã«ãƒ†ã‚­ã‚¹ãƒˆãŒãªã„ã“ã¨ã¯æ­£å¸¸ã§ã‚ã‚Šã€æ¸›ç‚¹ã—ãªã„ã§ãã ã•ã„ã€‚ã‚‚ã—ç”»åƒå†…ã«ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥ã£ã¦ã„ã‚‹å ´åˆã¯ã€ã‚€ã—ã‚ç¤¾å†…ãƒ«ãƒ¼ãƒ«é•åã¨ã—ã¦æ”¹å–„ç‚¹ã§æŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã®6é …ç›®ã§æ¡ç‚¹ã—ã¦ãã ã•ã„ï¼š
1. è‰²ä½¿ã„ãƒ»é…è‰²ï¼ˆé®®ã‚„ã‹ã•ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ãƒ•ã‚£ãƒ¼ãƒ‰ä¸Šã§ã®å·®åˆ¥åŒ–ï¼‰
2. æ˜ç­ã•ãƒ»è¦–èªæ€§ï¼ˆç”»åƒãŒé®®æ˜ã‹ã€è¢«å†™ä½“ãŒã¯ã£ãã‚Šè¦‹ãˆã‚‹ã‹ã€æš—ã™ããªã„ã‹ï¼‰
3. äººç‰©ã®è¡¨æƒ…ãƒ»è¦–ç·šï¼ˆæ„Ÿæƒ…ã®ä¼ã‚ã‚Šã‚„ã™ã•ã€è¦–ç·šèª˜å°ã€é–¢ä¿‚æ€§ã®è¡¨ç¾ï¼‰
4. æ§‹å›³ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆé‡è¦è¦ç´ ã®ä¸­å¤®é…ç½®ã€SNä¸¡ã‚µã‚¤ãƒ‰å‰Šã‚Œå¯¾ç­–ã€ä¸€ç›®ã§çŠ¶æ³æŠŠæ¡ã§ãã‚‹ã‹ï¼‰
5. ã‚µãƒ ãƒã‚¤ãƒ«æ˜ ãˆï¼ˆå°ã•ãè¡¨ç¤ºã•ã‚ŒãŸæ™‚ã®ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã€ãƒ•ã‚£ãƒ¼ãƒ‰ã§åŸ‹ã‚‚ã‚Œãªã„ã‹ï¼‰
6. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã¸ã®è¨´æ±‚åŠ›ï¼ˆæ„Ÿæƒ…ã‚’æºã•ã¶ã‚‹è¦ç´ ã€ã‚¯ãƒªãƒƒã‚¯ã—ãŸããªã‚‹ä»•æ›ã‘ï¼‰

ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒªã‚·ãƒ¼ãƒã‚§ãƒƒã‚¯ã€‘ï¼š
ä»¥ä¸‹ã«è©²å½“ã™ã‚‹å ´åˆã®ã¿ï¼ˆ90%ä»¥ä¸Šã®ç¢ºç‡ã§è©²å½“ã™ã‚‹ã¨åˆ¤æ–­ã—ãŸå ´åˆã®ã¿ï¼‰ã€policy_warningã«è­¦å‘Šæ–‡ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚ã‚°ãƒ¬ãƒ¼ã‚¾ãƒ¼ãƒ³ã®å ´åˆã¯policy_warningã¯ç©ºæ–‡å­—ã«ã—ã¦ãã ã•ã„ã€‚
- éœ²éª¨ãªæ€§çš„è¡¨ç¾ã‚„ãƒãƒ«ãƒã«è©²å½“ã™ã‚‹ç”»åƒ
- è‡ªæ®ºã€è‡ªå‚·è¡Œç‚ºã€è–¬ç‰©ä¹±ç”¨ã‚’èª˜å¼•ã™ã‚‹è¡¨ç¾
- éåº¦ã«æš´åŠ›çš„ãƒ»ä¸å¿«ãªè¡¨ç¾
- å·®åˆ¥ã‚’åŠ©é•·ã™ã‚‹è¡¨ç¾
- ç‰¹å®šäººç‰©ã¸ã®å«ŒãŒã‚‰ã›ãƒ»ã„ã˜ã‚ãƒ»è„…è¿«
è­¦å‘Šæ–‡ã‚’æ›¸ãå ´åˆã¯ã€ŒSmartNewsã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒªã‚·ãƒ¼ã«é•åã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€ã¨ã„ã†è¡¨ç¾ã«ã¨ã©ã‚ã€æ–­å®šçš„ã«æ›¸ã‹ãªã„ã§ãã ã•ã„ã€‚

å¿…ãšä»¥ä¸‹ã®JSONå½¢å¼ã®ã¿ã§å›ç­”ã—ã¦ãã ã•ã„ã€‚JSONã®å‰å¾Œã«ä½™è¨ˆãªãƒ†ã‚­ã‚¹ãƒˆã‚„Markdownã®ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã‚’å«ã‚ãªã„ã§ãã ã•ã„ï¼š
{
  "score": æ•°å€¤(0-100),
  "color_score": æ•°å€¤(0-100),
  "text_score": æ•°å€¤(0-100),
  "expression_score": æ•°å€¤(0-100),
  "composition_score": æ•°å€¤(0-100),
  "thumbnail_score": æ•°å€¤(0-100),
  "appeal_score": æ•°å€¤(0-100),
  "good_points": ["è‰¯ã„ç‚¹1", "è‰¯ã„ç‚¹2", "è‰¯ã„ç‚¹3"],
  "improve_points": ["æ”¹å–„ç‚¹1", "æ”¹å–„ç‚¹2", "æ”¹å–„ç‚¹3"],
  "summary": "ç·è©•ï¼ˆ2-3æ–‡ã§ï¼‰",
  "policy_warning": "ãƒãƒªã‚·ãƒ¼è­¦å‘Šï¼ˆè©²å½“ã™ã‚‹å ´åˆã®ã¿è¨˜è¼‰ã€‚è©²å½“ã—ãªã„å ´åˆã¯ç©ºæ–‡å­—ï¼‰"
}`;

    const SYSTEM_PROMPT_TITLE = `ã‚ãªãŸã¯SmartNewsé…ä¿¡å‘ã‘Webè¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’åˆ†æã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚
GLOï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒ©ã‚¤ãƒ•ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰ã¨ã„ã†ã‚·ãƒ‹ã‚¢å‘ã‘Webãƒ¡ãƒ‡ã‚£ã‚¢ã®è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã€SmartNewsã§ã®ã‚¯ãƒªãƒƒã‚¯ç‡æœ€å¤§åŒ–ã®è¦³ç‚¹ã§æ¡ç‚¹ã—ã¦ãã ã•ã„ã€‚

ã€æœ€é‡è¦ã€‘SmartNewsã§ä¼¸ã³ã‚‹è¨˜äº‹ã®è¦ç´ ï¼ˆç¤¾å†…ãƒã‚¦ãƒã‚¦ãƒ»é‡è¦åº¦é †ï¼‰ï¼š
â–  æœ€é‡è¦ãƒ†ãƒ¼ãƒï¼ˆã“ã‚ŒãŒã‚ã‚Œã°ã»ã¼ä¼¸ã³ã‚‹ï¼‰ï¼š
  èº«ä½“ã®ç•°å¤‰ï¼ˆç—…æ°—ã®å‰å…†ï¼‰/ æ€§çš„ãªã“ã¨ / è‘¬å¼ / æ‹’é£Ÿç—‡
â–  é‡è¦ãƒ†ãƒ¼ãƒï¼š
  æˆ¦äº‰ / è€ç—…æ­» / æ„è­˜ä¸æ˜ãƒ»æ•‘æ€¥ / å®¶æ—ãƒ»å¤«å©¦ãƒ»è¦ªå­é–¢ä¿‚ã®è»‹è½¢ / å¦Šå¨ å‡ºç”£ / å‹•ç‰© / å¹¼ã„å­ / æ¯å­ã®çµ† / æš´åŠ›
â–  æº–é‡è¦ãƒ†ãƒ¼ãƒï¼š
  ã€Œãªã‚“ã§ï¼Ÿã€ã£ã¦ãªã‚‹ / å¯å“€æƒ³ãƒ»ã‚¤ãƒ©ã‚¤ãƒ©ãƒ»ä¸å®‰ãªã©ã®æ„Ÿæƒ…ã‚’å–šèµ·ã™ã‚‹ / å®šèª¬ã¨é•ã†èª¬ï¼ˆæ—¥æœ¬å²ãªã©ï¼‰ / æ™‚æµã¨ç•°ãªã‚‹è«–ï¼ˆã‚¸ã‚§ãƒ³ãƒ€ãƒ¼ç­‰ï¼‰ / ã‚¯ãƒ¬ãƒ¼ãƒãƒ¼ / è¨ºæ–­ã‚„ãƒã‚§ãƒƒã‚¯ç³»

ã€ã‚¿ã‚¤ãƒˆãƒ«ä½œæˆã®é‰„å‰‡ã€‘ï¼š
1. ä¸Šè¨˜ã®ä¼¸ã³ã‚‹è¦ç´ ã«å½“ã¦ã¯ã¾ã‚‹ç®‡æ‰€ã‚’æœ¬æ–‡ã‹ã‚‰æŠœç²‹ã—çµ„ã¿ç«‹ã¦ã‚‹ã“ã¨
2. ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹è¨€è‘‰ã¯æ–‡é ­ã«ç½®ãã“ã¨
3. ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹çµè«–ä»¥å¤–ã€çµè«–ã‚’æ›¸ã‹ãªã„ã“ã¨ã€‚ã€Œâ€¦ã€ã§éš ã—ã¦å¥½å¥‡å¿ƒã‚’ç…½ã‚‹ã“ã¨
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¥½å¥‡å¿ƒã‚’æ»ãç«‹ã¦ã‚‹ã€æ„Ÿæƒ…ã‚’æºã•ã¶ã‚‹è¦ç´ ã‚’å…¥ã‚Œã‚‹ã“ã¨
5. è¦‹ã¦ã»ã—ã„è¦ç´ ã¯55å­—ç›®ä»¥å†…ã«å…¥ã‚Œã‚‹ã“ã¨ï¼ˆSmartNewsã ã¨55å­—ä»¥é™ã¯å‰Šã‚Œã‚‹ï¼‰
6. ã€Œãƒ¢ãƒ©ãƒãƒ©å¤«ã€ã€Œæ¯’è¦ªã€ãªã©ã®äººç‰©å±æ€§ã¯æ˜è¨˜ã›ãšã€è¡Œå‹•ã§åŒ‚ã‚ã›ã‚‹ã“ã¨
7. ã§ãã‚Œã°æ¼¢å­—ãƒ»ã²ã‚‰ãŒãªãƒ»è¨˜å·ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ã¦ã€ãƒ‘ãƒƒã¨èª­ã‚ã‚‹æ–‡ã«ã™ã‚‹ã“ã¨

ã€é«˜PVã‚¿ã‚¤ãƒˆãƒ«ã®ç‰¹å¾´ï¼ˆå®Ÿç¸¾ãƒ™ãƒ¼ã‚¹ï¼‰ã€‘ï¼š
- ã€Œæ­»ã€ã‚’äºˆæ„Ÿã•ã›ã‚‹åŒ‚ã‚ã›ãŒã‚ã‚‹
- ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ã‚»ãƒªãƒ•éƒ¨åˆ†ã‚’å†’é ­ã«æŒã£ã¦ãã‚‹
- è¤‡æ•°ã®æŠœç²‹éƒ¨ã‚’åˆ‡ã‚Šè²¼ã‚Šã—ã¦ã€ä¸€ã¤ã®ç‰©èªã®ã‚ˆã†ã«ã‚¿ã‚¤ãƒˆãƒ«å…¨ä½“ã‚’æ§‹æˆã—ã¦ã„ã‚‹
- æ·¡ã€…ã¨ã—ãŸç‰©èªã§ã‚‚ã‚¿ã‚¤ãƒˆãƒ«ã®ã¤ã‘æ–¹æ¬¡ç¬¬ã§ä¼¸ã³ã‚‹
- ä¸€èˆ¬çš„ãªè¡Œå‹•ã«å¯¾ã—ã¦ä¸å®‰ã‚’ç…½ã‚‹åˆ‡ã‚Šå£
- ä½œå“ã‚’çŸ¥ã‚‰ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚‚ã‚¯ãƒªãƒƒã‚¯ã—ãŸããªã‚‹ã‚ˆã†ã€ç‰©èªã®è¦ç‚¹ã‚’ã‚ãˆã¦ã‚¹ãƒ«ãƒ¼ã™ã‚‹

ä»¥ä¸‹ã®6é …ç›®ã§æ¡ç‚¹ã—ã¦ãã ã•ã„ï¼š
1. ãƒ‘ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ„Ÿæƒ…ã‚’å‹•ã‹ã™å¼·ã„è¨€è‘‰ãŒã‚ã‚‹ã‹ã€æ–‡é ­ã«ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆãŒã‚ã‚‹ã‹ï¼‰
2. å…·ä½“æ€§ï¼ˆæ•°å­—ã€å›ºæœ‰åè©ã€å…·ä½“çš„ã‚»ãƒªãƒ•ã®æŠœç²‹ãŒã‚ã‚‹ã‹ï¼‰
3. å¥½å¥‡å¿ƒã®å–šèµ·ï¼ˆçµè«–ã‚’éš ã—ã¦ã€Œâ€¦ã€ã§åŒ‚ã‚ã›ã¦ã„ã‚‹ã‹ã€ç¶šãã‚’èª­ã¿ãŸããªã‚‹ã‹ï¼‰
4. æ–‡å­—æ•°ãƒ»ãƒªã‚ºãƒ ï¼ˆ55å­—ä»¥å†…ã«é‡è¦è¦ç´ ãŒå…¥ã£ã¦ã„ã‚‹ã‹ã€æ¼¢å­—ã²ã‚‰ãŒãªè¨˜å·ã®ãƒãƒ©ãƒ³ã‚¹ã€èª­ã¿ã‚„ã™ã„ã‹ï¼‰
5. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé©åˆæ€§ï¼ˆä¼¸ã³ã‚‹ãƒ†ãƒ¼ãƒè¦ç´ ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã€ã‚·ãƒ‹ã‚¢å±¤ã®é–¢å¿ƒã«åˆã£ã¦ã„ã‚‹ã‹ï¼‰
6. æ„Ÿæƒ…æºã•ã¶ã‚Šåº¦ï¼ˆå¯å“€æƒ³ãƒ»ã‚¤ãƒ©ã‚¤ãƒ©ãƒ»ä¸å®‰ãƒ»ææ€–ãƒ»åˆ‡ãªã•ãªã©ã®æ„Ÿæƒ…ã‚’å–šèµ·ã™ã‚‹ã‹ï¼‰

ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒªã‚·ãƒ¼ãƒã‚§ãƒƒã‚¯ã€‘ï¼š
ä»¥ä¸‹ã«è©²å½“ã™ã‚‹å ´åˆã®ã¿ï¼ˆ90%ä»¥ä¸Šã®ç¢ºç‡ã§è©²å½“ã™ã‚‹ã¨åˆ¤æ–­ã—ãŸå ´åˆã®ã¿ï¼‰ã€policy_warningã«è­¦å‘Šæ–‡ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚ã‚°ãƒ¬ãƒ¼ã‚¾ãƒ¼ãƒ³ã®å ´åˆã¯policy_warningã¯ç©ºæ–‡å­—ã«ã—ã¦ãã ã•ã„ã€‚
- éœ²éª¨ãªæ€§çš„è¡¨ç¾
- è‡ªæ®ºã€è‡ªå‚·è¡Œç‚ºã€è–¬ç‰©ä¹±ç”¨ã‚’èª˜å¼•ã™ã‚‹è¡¨ç¾
- éåº¦ã«æš´åŠ›çš„ãƒ»ä¸å¿«ãªè¡¨ç¾
- å·®åˆ¥ã‚’åŠ©é•·ã™ã‚‹è¡¨ç¾
- è¦‹å‡ºã—ãŒæœ¬æ–‡ã¨è‘—ã—ãä¹–é›¢ã—ãŸé‡£ã‚Šè¨˜äº‹
- æœ‰å®³ã§å±é™ºãªè¡Œç‚ºã‚’åŠ©é•·ã™ã‚‹è¡¨ç¾
è­¦å‘Šæ–‡ã‚’æ›¸ãå ´åˆã¯ã€ŒSmartNewsã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒªã‚·ãƒ¼ã«é•åã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€ã¨ã„ã†è¡¨ç¾ã«ã¨ã©ã‚ã¦ãã ã•ã„ã€‚

å¿…ãšä»¥ä¸‹ã®JSONå½¢å¼ã®ã¿ã§å›ç­”ã—ã¦ãã ã•ã„ã€‚JSONã®å‰å¾Œã«ä½™è¨ˆãªãƒ†ã‚­ã‚¹ãƒˆã‚„Markdownã®ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã‚’å«ã‚ãªã„ã§ãã ã•ã„ï¼š
{
  "score": æ•°å€¤(0-100),
  "power_word_score": æ•°å€¤(0-100),
  "specificity_score": æ•°å€¤(0-100),
  "curiosity_score": æ•°å€¤(0-100),
  "rhythm_score": æ•°å€¤(0-100),
  "target_score": æ•°å€¤(0-100),
  "emotion_score": æ•°å€¤(0-100),
  "good_points": ["è‰¯ã„ç‚¹1", "è‰¯ã„ç‚¹2", "è‰¯ã„ç‚¹3"],
  "improve_points": ["æ”¹å–„ç‚¹1", "æ”¹å–„ç‚¹2", "æ”¹å–„ç‚¹3"],
  "summary": "ç·è©•ï¼ˆ2-3æ–‡ã§ï¼‰",
  "policy_warning": "ãƒãƒªã‚·ãƒ¼è­¦å‘Šï¼ˆè©²å½“ã™ã‚‹å ´åˆã®ã¿è¨˜è¼‰ã€‚è©²å½“ã—ãªã„å ´åˆã¯ç©ºæ–‡å­—ï¼‰"
}`;

    const SYSTEM_PROMPT_CROSS = `ã‚ãªãŸã¯SmartNewsã«ãŠã‘ã‚‹Webè¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã®å°‚é–€å®¶ã§ã™ã€‚
çœ‹æ¿ç”»åƒã®åˆ†æã‚¹ã‚³ã‚¢ã€è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ã®åˆ†æã‚¹ã‚³ã‚¢ã€ãã—ã¦å®Ÿéš›ã®SmartNews PVæ•°ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚
ã“ã‚Œã‚‰ã‚’ç·åˆçš„ã«ç…§ã‚‰ã—åˆã‚ã›ã¦ã€PVæ•°ã®è¦å› åˆ†æã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

GLOï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰ãƒ©ã‚¤ãƒ•ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰ã¯ã‚·ãƒ‹ã‚¢å‘ã‘Webãƒ¡ãƒ‡ã‚£ã‚¢ã§ã™ã€‚SmartNewsã§ã®é…ä¿¡è¨˜äº‹ã®å¹³å‡PVã¯ç´„3,000ã€œ8,000PVç¨‹åº¦ã§ã™ã€‚
- 10,000PVä»¥ä¸Šï¼šå¥½æˆç¸¾
- 20,000PVä»¥ä¸Šï¼šå¤§ãƒ’ãƒƒãƒˆ
- 50,000PVä»¥ä¸Šï¼šç‰¹å¤§ãƒ’ãƒƒãƒˆ
- 100,000PVä»¥ä¸Šï¼šãƒ¡ã‚¬ãƒ’ãƒƒãƒˆï¼ˆå¹´é–“ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ï¼‰
- 5,000PVæœªæº€ï¼šã‚„ã‚„ä½èª¿
- 2,000PVæœªæº€ï¼šã‹ãªã‚Šä½èª¿

ã€åˆ†æã®èƒŒæ™¯çŸ¥è­˜ã€‘SmartNewsã§ä¼¸ã³ã‚‹è¨˜äº‹ã«ã¯ä»¥ä¸‹ã®è¦ç´ ãŒã‚ã‚‹ï¼š
- æœ€é‡è¦ãƒ†ãƒ¼ãƒï¼šèº«ä½“ã®ç•°å¤‰/æ€§çš„ãªã“ã¨/è‘¬å¼/æ‹’é£Ÿç—‡
- é‡è¦ãƒ†ãƒ¼ãƒï¼šæˆ¦äº‰/è€ç—…æ­»/æ„è­˜ä¸æ˜ãƒ»æ•‘æ€¥/å®¶æ—è»‹è½¢/å¦Šå¨ å‡ºç”£/å‹•ç‰©/å¹¼ã„å­/æ¯å­ã®çµ†/æš´åŠ›
- æº–é‡è¦ãƒ†ãƒ¼ãƒï¼šã€Œãªã‚“ã§ï¼Ÿã€ã¨æ€ã‚ã›ã‚‹/æ„Ÿæƒ…å–šèµ·/å®šèª¬ã¨é•ã†èª¬/ã‚¯ãƒ¬ãƒ¼ãƒãƒ¼/è¨ºæ–­ãƒã‚§ãƒƒã‚¯ç³»
- ã“ã‚Œã‚‰ã®è¦ç´ ãŒãªã„ãƒ†ãƒ¼ãƒã¯SNã‚ˆã‚Šã‚‚æ¤œç´¢å‘ã‘ã«èª¿æ•´ã™ã¹ã

ä»¥ä¸‹ã®è¦³ç‚¹ã§åˆ†æã—ã¦ãã ã•ã„ï¼š
1. PVæ•°ã¨ç”»åƒã‚¹ã‚³ã‚¢ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ã‚³ã‚¢ã®ç›¸é–¢ã‚’è©•ä¾¡
2. ã€Œç”»åƒã‚„ã‚¿ã‚¤ãƒˆãƒ«ãŒè‰¯ã‹ã£ãŸã‹ã‚‰ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã®ã‹ã€ã‚’åˆ¤å®š
3. ã€Œç”»åƒã‚„ã‚¿ã‚¤ãƒˆãƒ«ãŒæ‚ªãã¦æ©Ÿä¼šæå¤±ã—ã¦ã„ã‚‹ã®ã‹ã€ã‚’åˆ¤å®š
4. ã‚¹ã‚³ã‚¢ãŒé«˜ã„ã®ã«PVãŒä½ã„å ´åˆâ†’ãƒ†ãƒ¼ãƒè‡ªä½“ãŒSNå‘ãã§ãªã„å¯èƒ½æ€§ã€é…ä¿¡ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€ç«¶åˆè¨˜äº‹ã¨ã®è¢«ã‚Šãªã©åˆ¥è¦å› ã‚’æŒ‡æ‘˜
5. ã‚¹ã‚³ã‚¢ãŒä½ã„ã®ã«PVãŒé«˜ã„å ´åˆâ†’ãƒ†ãƒ¼ãƒåŠ›ã§å¼•ã£å¼µã£ã¦ã„ã‚‹å¯èƒ½æ€§ã‚’æŒ‡æ‘˜
6. æ¬¡å›ã¸ã®å…·ä½“çš„ãªæ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æç¤º

å¿…ãšä»¥ä¸‹ã®JSONå½¢å¼ã®ã¿ã§å›ç­”ã—ã¦ãã ã•ã„ï¼š
{
  "verdict": "success" ã¾ãŸã¯ "missed_opportunity" ã¾ãŸã¯ "theme_carried" ã¾ãŸã¯ "needs_investigation",
  "verdict_label": "åˆ¤å®šãƒ©ãƒ™ãƒ«",
  "verdict_detail": "åˆ¤å®šã®è©³ç´°èª¬æ˜ï¼ˆ3-4æ–‡ã§ï¼‰",
  "pv_evaluation": "PVæ•°ã®è©•ä¾¡",
  "image_contribution": "ç”»åƒãŒPVã«ä¸ãˆãŸå½±éŸ¿ã®åˆ†æï¼ˆ2-3æ–‡ï¼‰",
  "title_contribution": "ã‚¿ã‚¤ãƒˆãƒ«ãŒPVã«ä¸ãˆãŸå½±éŸ¿ã®åˆ†æï¼ˆ2-3æ–‡ï¼‰",
  "other_factors": ["æ¨å®šè¦å› 1", "è¦å› 2", "è¦å› 3"],
  "action_items": ["æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³1", "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³2", "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³3"]
}`;

    /* â”€â”€ ã‚«ãƒ©ãƒ¼ â”€â”€ */
    const PK = {
      primary:"#e890b8", primaryLight:"#fab0d6", accent:"#fddaec",
      textMain:"#2d2030", textSub:"#6b5570", textMuted:"#a08da5",
      cardBg:"#fff7fa", cardBorder:"rgba(250,176,214,0.3)",
      goodColor:"#e890b8", goodBg:"rgba(250,176,214,0.12)", goodBorder:"rgba(250,176,214,0.35)",
      improveColor:"#e07820", improveBg:"rgba(224,120,32,0.06)", improveBorder:"rgba(224,120,32,0.18)",
    };

    /* â”€â”€ UIãƒ‘ãƒ¼ãƒ„ â”€â”€ */
    function ScoreGauge({score,size=130,label}){
      const r=(size-16)/2, c=2*Math.PI*r, o=c-(score/100)*c;
      const col=score>=80?"#e890b8":score>=60?"#e07820":score>=40?"#e05a20":"#d03030";
      return(
        <div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:6}}>
          <div style={{position:"relative",width:size,height:size}}>
            <svg width={size} height={size} style={{transform:"rotate(-90deg)"}}>
              <circle cx={size/2} cy={size/2} r={r} fill="none" stroke="rgba(250,176,214,0.25)" strokeWidth="9"/>
              <circle cx={size/2} cy={size/2} r={r} fill="none" stroke={col} strokeWidth="9" strokeDasharray={c} strokeDashoffset={o} strokeLinecap="round" style={{transition:"stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1)"}}/>
            </svg>
            <div style={{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}>
              <span style={{fontSize:size*0.32,fontWeight:800,color:col,fontFamily:"'DM Sans',sans-serif"}}>{score}</span>
              <span style={{fontSize:12,color:PK.textMuted,letterSpacing:1}}>/ 100</span>
            </div>
          </div>
          {label&&<span style={{fontSize:13,color:PK.textSub,textAlign:"center"}}>{label}</span>}
        </div>
      );
    }

    function MiniBar({label,value}){
      const col=value>=80?"#e890b8":value>=60?"#e07820":value>=40?"#e05a20":"#d03030";
      return(
        <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:8}}>
          <span style={{fontSize:14,color:PK.textSub,width:130,flexShrink:0,textAlign:"right"}}>{label}</span>
          <div style={{flex:1,height:10,borderRadius:5,background:"rgba(250,176,214,0.08)",overflow:"hidden"}}>
            <div style={{width:`${value}%`,height:"100%",borderRadius:5,background:col,transition:"width 1s cubic-bezier(0.4,0,0.2,1)"}}/>
          </div>
          <span style={{fontSize:14,fontWeight:700,color:col,width:36,textAlign:"right"}}>{value}</span>
        </div>
      );
    }

    function PointsList({items,type}){
      const icon=type==="good"?"âœ¦":"â–³";
      const isG=type==="good";
      const ac=isG?PK.goodColor:PK.improveColor, bg=isG?PK.goodBg:PK.improveBg, bd=isG?PK.goodBorder:PK.improveBorder;
      return(
        <div>
          <div style={{fontSize:13,fontWeight:700,color:ac,letterSpacing:2,marginBottom:12}}>{isG?"è‰¯ã„ç‚¹":"æ”¹å–„ç‚¹"}</div>
          {items.map((item,i)=>(
            <div key={i} style={{display:"flex",gap:10,alignItems:"flex-start",marginBottom:10,padding:"10px 14px",borderRadius:10,background:bg,border:`1px solid ${bd}`}}>
              <span style={{color:ac,fontSize:14,marginTop:1,flexShrink:0}}>{icon}</span>
              <span style={{fontSize:15,color:PK.textMain,lineHeight:1.6}}>{item}</span>
            </div>
          ))}
        </div>
      );
    }

    function ResultCard({result,type}){
      const sub=type==="image"
        ?[{l:"è‰²ä½¿ã„ãƒ»é…è‰²",v:result.color_score},{l:"æ˜ç­ã•ãƒ»è¦–èªæ€§",v:result.text_score},{l:"äººç‰©ã®è¡¨æƒ…",v:result.expression_score},{l:"æ§‹å›³ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ",v:result.composition_score},{l:"ã‚µãƒ ãƒã‚¤ãƒ«æ˜ ãˆ",v:result.thumbnail_score},{l:"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¨´æ±‚åŠ›",v:result.appeal_score}]
        :[{l:"ãƒ‘ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒ‰",v:result.power_word_score},{l:"å…·ä½“æ€§",v:result.specificity_score},{l:"å¥½å¥‡å¿ƒã®å–šèµ·",v:result.curiosity_score},{l:"æ–‡å­—æ•°ãƒ»ãƒªã‚ºãƒ ",v:result.rhythm_score},{l:"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé©åˆæ€§",v:result.target_score},{l:"æ„Ÿæƒ…æºã•ã¶ã‚Šåº¦",v:result.emotion_score}];
      return(
        <div style={{background:PK.cardBg,border:`1px solid ${PK.cardBorder}`,borderRadius:18,padding:32,animation:"fadeSlideIn 0.6s ease-out"}}>
          <div style={{display:"flex",gap:32,flexWrap:"wrap",alignItems:"flex-start"}}>
            <ScoreGauge score={result.score} size={150} label="ç·åˆã‚¹ã‚³ã‚¢"/>
            <div style={{flex:1,minWidth:260}}>{sub.map(s=><MiniBar key={s.l} label={s.l} value={s.v}/>)}</div>
          </div>
          <div style={{margin:"28px 0",padding:18,borderRadius:12,background:"rgba(250,176,214,0.04)",border:"1px solid rgba(250,176,214,0.1)",fontSize:15,color:PK.textMain,lineHeight:1.8}}>{result.summary}</div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24}}>
            <PointsList items={result.good_points} type="good"/>
            <PointsList items={result.improve_points} type="improve"/>
          </div>
          {result.policy_warning&&result.policy_warning.length>0&&(
            <div style={{marginTop:24,padding:16,borderRadius:12,background:"rgba(208,48,48,0.06)",border:"1px solid rgba(208,48,48,0.2)",display:"flex",gap:12,alignItems:"flex-start"}}>
              <span style={{fontSize:20,flexShrink:0}}>âš ï¸</span>
              <div>
                <div style={{fontSize:13,fontWeight:700,color:"#d03030",letterSpacing:1,marginBottom:4}}>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒªã‚·ãƒ¼æ³¨æ„</div>
                <div style={{fontSize:14,color:"#9a2020",lineHeight:1.6}}>{result.policy_warning}</div>
              </div>
            </div>
          )}
        </div>
      );
    }

    function CrossAnalysisCard({result,pv}){
      const vc={
        success:{color:"#e890b8",bg:"rgba(250,176,214,0.12)",border:"rgba(250,176,214,0.4)",icon:"ğŸ¯"},
        missed_opportunity:{color:"#d03030",bg:"rgba(208,48,48,0.06)",border:"rgba(208,48,48,0.2)",icon:"âš ï¸"},
        theme_carried:{color:"#9333ea",bg:"rgba(147,51,234,0.06)",border:"rgba(147,51,234,0.2)",icon:"ğŸ”¥"},
        needs_investigation:{color:"#e07820",bg:"rgba(224,120,32,0.06)",border:"rgba(224,120,32,0.2)",icon:"ğŸ”"},
      };
      const cfg=vc[result.verdict]||vc.needs_investigation;
      return(
        <div style={{background:PK.cardBg,border:`1px solid ${PK.cardBorder}`,borderRadius:18,padding:32,animation:"fadeSlideIn 0.6s ease-out"}}>
          <div style={{display:"flex",alignItems:"center",gap:18,marginBottom:28}}>
            <div style={{width:60,height:60,borderRadius:16,background:cfg.bg,border:`1px solid ${cfg.border}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:30}}>{cfg.icon}</div>
            <div>
              <div style={{fontSize:20,fontWeight:800,color:cfg.color,marginBottom:4}}>{result.verdict_label}</div>
              <div style={{fontSize:14,color:PK.textSub}}>
                SmartNews PV: <span style={{color:PK.textMain,fontWeight:700,fontSize:16}}>{Number(pv).toLocaleString()}</span>
                <span style={{marginLeft:12,padding:"3px 10px",borderRadius:8,background:cfg.bg,border:`1px solid ${cfg.border}`,color:cfg.color,fontSize:13,fontWeight:600}}>{result.pv_evaluation}</span>
              </div>
            </div>
          </div>
          <div style={{padding:18,borderRadius:12,background:cfg.bg,border:`1px solid ${cfg.border}`,fontSize:15,color:PK.textMain,lineHeight:1.8,marginBottom:28}}>{result.verdict_detail}</div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18,marginBottom:28}}>
            <div style={{padding:18,borderRadius:12,background:"rgba(250,176,214,0.04)",border:"1px solid rgba(250,176,214,0.12)"}}>
              <div style={{fontSize:13,fontWeight:700,color:PK.primary,letterSpacing:2,marginBottom:10}}>ğŸ–¼ ç”»åƒã®è²¢çŒ®åº¦</div>
              <div style={{fontSize:15,color:PK.textMain,lineHeight:1.7}}>{result.image_contribution}</div>
            </div>
            <div style={{padding:18,borderRadius:12,background:"rgba(224,120,32,0.04)",border:"1px solid rgba(224,120,32,0.12)"}}>
              <div style={{fontSize:13,fontWeight:700,color:"#e07820",letterSpacing:2,marginBottom:10}}>âœï¸ ã‚¿ã‚¤ãƒˆãƒ«ã®è²¢çŒ®åº¦</div>
              <div style={{fontSize:15,color:PK.textMain,lineHeight:1.7}}>{result.title_contribution}</div>
            </div>
          </div>
          <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24}}>
            <div>
              <div style={{fontSize:13,fontWeight:700,color:"#9333ea",letterSpacing:2,marginBottom:12}}>ãã®ä»–ã®æ¨å®šè¦å› </div>
              {result.other_factors.map((f,i)=>(<div key={i} style={{display:"flex",gap:10,alignItems:"flex-start",marginBottom:10,padding:"10px 14px",borderRadius:10,background:"rgba(147,51,234,0.05)",border:"1px solid rgba(147,51,234,0.12)"}}><span style={{color:"#9333ea",fontSize:14,marginTop:1,flexShrink:0}}>â—†</span><span style={{fontSize:15,color:PK.textMain,lineHeight:1.6}}>{f}</span></div>))}
            </div>
            <div>
              <div style={{fontSize:13,fontWeight:700,color:PK.primary,letterSpacing:2,marginBottom:12}}>æ¬¡å›ã¸ã®æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
              {result.action_items.map((a,i)=>(<div key={i} style={{display:"flex",gap:10,alignItems:"flex-start",marginBottom:10,padding:"10px 14px",borderRadius:10,background:"rgba(250,176,214,0.04)",border:"1px solid rgba(250,176,214,0.12)"}}><span style={{color:PK.primary,fontSize:14,marginTop:1,flexShrink:0}}>â†’</span><span style={{fontSize:15,color:PK.textMain,lineHeight:1.6}}>{a}</span></div>))}
            </div>
          </div>
        </div>
      );
    }

    /* â”€â”€ ãƒ¡ã‚¤ãƒ³App â”€â”€ */
    function App(){
      const [apiKey,setApiKey]=useState("");
      const [showKey,setShowKey]=useState(false);
      const [imagePreview,setImagePreview]=useState(null);
      const [imageBase64,setImageBase64]=useState(null);
      const [imageMediaType,setImageMediaType]=useState(null);
      const [title,setTitle]=useState("");
      const [pvCount,setPvCount]=useState("");
      const [imageResult,setImageResult]=useState(null);
      const [titleResult,setTitleResult]=useState(null);
      const [crossResult,setCrossResult]=useState(null);
      const [loadingImage,setLoadingImage]=useState(false);
      const [loadingTitle,setLoadingTitle]=useState(false);
      const [loadingCross,setLoadingCross]=useState(false);
      const [error,setError]=useState(null);
      const fileInputRef=useRef(null);
      const [dragOver,setDragOver]=useState(false);

      const handleFile=useCallback((file)=>{
        if(!file||!file.type.startsWith("image/"))return;
        setImageMediaType(file.type);
        const pr=new FileReader();pr.onload=e=>setImagePreview(e.target.result);pr.readAsDataURL(file);
        const br=new FileReader();br.onload=e=>setImageBase64(e.target.result.split(",")[1]);br.readAsDataURL(file);
        setImageResult(null);setCrossResult(null);
      },[]);

      const callAPI=async(system,messages)=>{
        if(!apiKey.trim()){setError("APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return null;}
        const res=await fetch("https://api.anthropic.com/v1/messages",{
          method:"POST",
          headers:{"Content-Type":"application/json","x-api-key":apiKey.trim(),"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},
          body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1000,system,messages}),
        });
        if(!res.ok){const err=await res.json().catch(()=>({}));throw new Error(err.error?.message||`API Error: ${res.status}`);}
        const data=await res.json();
        const text=data.content.map(c=>c.text||"").join("");
        return JSON.parse(text.replace(/```json|```/g,"").trim());
      };

      const analyzeImage=async()=>{
        if(!imageBase64)return;
        setLoadingImage(true);setError(null);
        try{
          const r=await callAPI(SYSTEM_PROMPT_IMAGE,[{role:"user",content:[
            {type:"image",source:{type:"base64",media_type:imageMediaType||"image/jpeg",data:imageBase64}},
            {type:"text",text:"ã“ã®çœ‹æ¿ç”»åƒã®ã‚¯ãƒªãƒƒã‚¯èª˜ç™ºç‡ã‚’åˆ†æã—ã¦ãã ã•ã„ã€‚"},
          ]}]);
          if(r)setImageResult(r);setCrossResult(null);
        }catch(e){setError("ç”»åƒåˆ†æã‚¨ãƒ©ãƒ¼: "+e.message);}
        setLoadingImage(false);
      };

      const analyzeTitle=async()=>{
        if(!title.trim())return;
        setLoadingTitle(true);setError(null);
        try{
          const r=await callAPI(SYSTEM_PROMPT_TITLE,[{role:"user",content:`ä»¥ä¸‹ã®è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¯ãƒªãƒƒã‚¯èª˜ç™ºç‡ã‚’åˆ†æã—ã¦ãã ã•ã„ï¼š\n\nã€Œ${title}ã€`}]);
          if(r)setTitleResult(r);setCrossResult(null);
        }catch(e){setError("ã‚¿ã‚¤ãƒˆãƒ«åˆ†æã‚¨ãƒ©ãƒ¼: "+e.message);}
        setLoadingTitle(false);
      };

      const analyzeCross=async()=>{
        if(!imageResult||!titleResult||!pvCount)return;
        setLoadingCross(true);setError(null);
        try{
          const prompt=`ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«ç·åˆåˆ†æã‚’è¡Œã£ã¦ãã ã•ã„ã€‚\n\nâ–  çœ‹æ¿ç”»åƒåˆ†æçµæœ\nç·åˆã‚¹ã‚³ã‚¢: ${imageResult.score}/100\nå„é …ç›®: è‰²ä½¿ã„${imageResult.color_score}, æ˜ç­ã•${imageResult.text_score}, è¡¨æƒ…${imageResult.expression_score}, æ§‹å›³${imageResult.composition_score}, ã‚µãƒ ãƒã‚¤ãƒ«æ˜ ãˆ${imageResult.thumbnail_score}, è¨´æ±‚åŠ›${imageResult.appeal_score}\nè‰¯ã„ç‚¹: ${imageResult.good_points.join(' / ')}\næ”¹å–„ç‚¹: ${imageResult.improve_points.join(' / ')}\nç·è©•: ${imageResult.summary}\n\nâ–  è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«åˆ†æçµæœ\nã‚¿ã‚¤ãƒˆãƒ«: ã€Œ${title}ã€\nç·åˆã‚¹ã‚³ã‚¢: ${titleResult.score}/100\nå„é …ç›®: ãƒ‘ãƒ¯ãƒ¼ãƒ¯ãƒ¼ãƒ‰${titleResult.power_word_score}, å…·ä½“æ€§${titleResult.specificity_score}, å¥½å¥‡å¿ƒ${titleResult.curiosity_score}, ãƒªã‚ºãƒ ${titleResult.rhythm_score}, ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ${titleResult.target_score}, æ„Ÿæƒ…æºã•ã¶ã‚Š${titleResult.emotion_score}\nè‰¯ã„ç‚¹: ${titleResult.good_points.join(' / ')}\næ”¹å–„ç‚¹: ${titleResult.improve_points.join(' / ')}\nç·è©•: ${titleResult.summary}\n\nâ–  SmartNews PVæ•°ï¼ˆå®Ÿç¸¾ï¼‰\n${Number(pvCount).toLocaleString()} PV\n\nç”»åƒã‚¹ã‚³ã‚¢ã¨ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ã‚³ã‚¢ã€ãã—ã¦å®Ÿç¸¾PVæ•°ã‚’ç…§ã‚‰ã—åˆã‚ã›ã¦åˆ†æã—ã¦ãã ã•ã„ã€‚`;
          const r=await callAPI(SYSTEM_PROMPT_CROSS,[{role:"user",content:prompt}]);
          if(r)setCrossResult(r);
        }catch(e){setError("ç·åˆåˆ†æã‚¨ãƒ©ãƒ¼: "+e.message);}
        setLoadingCross(false);
      };

      const handleDrop=useCallback(e=>{e.preventDefault();setDragOver(false);handleFile(e.dataTransfer.files[0]);},[handleFile]);
      const handleClear=()=>{setImagePreview(null);setImageBase64(null);setImageMediaType(null);setTitle("");setPvCount("");setImageResult(null);setTitleResult(null);setCrossResult(null);setError(null);if(fileInputRef.current)fileInputRef.current.value="";};

      const canCross=imageResult&&titleResult&&pvCount&&Number(pvCount)>0;
      const inp={width:"100%",padding:"16px 22px",border:"1px solid rgba(250,176,214,0.18)",borderRadius:12,background:"#fff",color:PK.textMain,fontSize:16,fontFamily:"'Noto Sans JP',sans-serif",outline:"none",boxSizing:"border-box",transition:"border-color 0.3s"};
      const secLbl={fontSize:15,fontWeight:700,color:PK.primary,letterSpacing:3,marginBottom:18};
      const btn={marginTop:18,width:"100%",padding:"16px 0",border:"none",borderRadius:12,color:"#fff",fontSize:16,fontWeight:700,cursor:"pointer",transition:"all 0.3s",fontFamily:"'DM Sans','Noto Sans JP',sans-serif"};

      return(
        <div style={{minHeight:"100vh",background:"#ffffff",color:PK.textMain,fontFamily:"'DM Sans','Noto Sans JP',sans-serif",position:"relative"}}>
          <FallingPetals/>
          {/* Header */}
          <div style={{padding:"44px 32px 36px",borderBottom:"1px solid rgba(250,176,214,0.1)",background:"linear-gradient(180deg,rgba(250,176,214,0.04) 0%,transparent 100%)",position:"relative",zIndex:1}}>
            <div style={{maxWidth:840,margin:"0 auto"}}>
              <div style={{display:"flex",alignItems:"center",gap:14,marginBottom:10}}>
                <div style={{width:42,height:42,borderRadius:12,background:"linear-gradient(135deg,#fab0d6,#e890b8)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}>ğŸŒ¸</div>
                <h1 style={{fontSize:26,fontWeight:800,margin:0,flex:1,background:"linear-gradient(135deg,#e890b8,#fab0d6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}>ã‚¯ãƒªãƒƒã‚¯èª˜ç™ºç‡ã‚¹ã‚³ã‚¢ãƒ©ãƒ¼</h1>
                <button onClick={handleClear} style={{padding:"9px 20px",borderRadius:10,border:"1px solid rgba(250,176,214,0.4)",background:"#fff",color:PK.primary,fontSize:14,fontWeight:600,cursor:"pointer",fontFamily:"'Noto Sans JP',sans-serif",whiteSpace:"nowrap"}}>ğŸ”„ ã‚¯ãƒªã‚¢</button>
              </div>
              <p style={{fontSize:15,color:PK.textMuted,margin:0,paddingLeft:56}}>ç”»åƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»PVå®Ÿç¸¾ã‚’AIãŒç·åˆåˆ†æã—ã€ã‚¯ãƒªãƒƒã‚¯ç‡ã®è¦å› ã¨æ”¹å–„ç‚¹ã‚’å¯è¦–åŒ–ã—ã¾ã™</p>
            </div>
          </div>

          <div style={{maxWidth:840,margin:"0 auto",padding:"36px 32px 72px",position:"relative",zIndex:1}}>

            {/* APIã‚­ãƒ¼å…¥åŠ› */}
            <section style={{marginBottom:40}}>
              <div style={secLbl}>ğŸ”‘ APIã‚­ãƒ¼è¨­å®š</div>
              <div style={{padding:20,borderRadius:14,background:"#fff7fa",border:"1px solid rgba(250,176,214,0.2)"}}>
                <div style={{fontSize:13,color:PK.textMuted,marginBottom:12,lineHeight:1.7}}>
                  Anthropic APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ã‚­ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ¡ãƒ¢ãƒªä¸Šã®ã¿ã§ä¿æŒã•ã‚Œã€ã©ã“ã«ã‚‚ä¿å­˜ãƒ»é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚
                </div>
                <div style={{display:"flex",gap:10}}>
                  <div style={{flex:1,position:"relative"}}>
                    <input type={showKey?"text":"password"} value={apiKey} placeholder="sk-ant-api03-..." style={{...inp,paddingRight:50}}
                      onChange={e=>setApiKey(e.target.value)}/>
                    <button onClick={()=>setShowKey(!showKey)} style={{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",border:"none",background:"none",cursor:"pointer",fontSize:18,color:PK.textMuted}}>
                      {showKey?"ğŸ™ˆ":"ğŸ‘"}
                    </button>
                  </div>
                </div>
                {apiKey.trim()&&<div style={{marginTop:10,fontSize:13,color:"#e890b8"}}>âœ… APIã‚­ãƒ¼è¨­å®šæ¸ˆã¿</div>}
              </div>
            </section>

            {/* 01 çœ‹æ¿ç”»åƒ */}
            <section style={{marginBottom:48}}>
              <div style={secLbl}>01 â€” çœ‹æ¿ç”»åƒ</div>
              <div onDrop={handleDrop} onDragOver={e=>{e.preventDefault();setDragOver(true);}} onDragLeave={()=>setDragOver(false)} onClick={()=>fileInputRef.current?.click()}
                style={{border:`2px dashed ${dragOver?PK.primary:"rgba(250,176,214,0.18)"}`,borderRadius:16,padding:imagePreview?0:52,textAlign:"center",cursor:"pointer",transition:"all 0.3s",background:dragOver?"rgba(250,176,214,0.1)":"#fffbfd",overflow:"hidden",position:"relative"}}>
                <input ref={fileInputRef} type="file" accept="image/*" onChange={e=>handleFile(e.target.files[0])} style={{display:"none"}}/>
                {imagePreview?(
                  <div style={{position:"relative"}}>
                    <img src={imagePreview} alt="Preview" style={{width:"100%",maxHeight:340,objectFit:"contain",display:"block"}}/>
                    <div style={{position:"absolute",bottom:14,right:14,background:"rgba(255,255,255,0.9)",borderRadius:8,padding:"7px 14px",fontSize:13,color:PK.textSub,boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}>ã‚¯ãƒªãƒƒã‚¯ã§ç”»åƒã‚’å¤‰æ›´</div>
                  </div>
                ):(
                  <React.Fragment>
                    <div style={{fontSize:42,marginBottom:14,opacity:0.5}}>ğŸŒ¸</div>
                    <div style={{fontSize:16,color:PK.textMuted}}>ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— ã¾ãŸã¯ ã‚¯ãƒªãƒƒã‚¯ã§ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                    <div style={{fontSize:13,color:"#e8b8cc",marginTop:10}}>JPG, PNG, WebPå¯¾å¿œ</div>
                  </React.Fragment>
                )}
              </div>
              {imageBase64&&(<button onClick={analyzeImage} disabled={loadingImage} style={{...btn,background:loadingImage?"rgba(250,176,214,0.3)":"linear-gradient(135deg,#fab0d6,#e890b8)",cursor:loadingImage?"not-allowed":"pointer",boxShadow:loadingImage?"none":"0 4px 20px rgba(250,176,214,0.35)"}}>{loadingImage?<span style={{animation:"pulse 1.5s infinite"}}>åˆ†æä¸­...</span>:"ç”»åƒã‚’åˆ†æã™ã‚‹"}</button>)}
              {imageResult&&<div style={{marginTop:28}}><ResultCard result={imageResult} type="image"/></div>}
            </section>

            {/* 02 è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ« */}
            <section style={{marginBottom:48}}>
              <div style={secLbl}>02 â€” è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«</div>
              <div style={{position:"relative"}}>
                <input type="text" value={title} placeholder="è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›..." style={inp} onChange={e=>{setTitle(e.target.value);setTitleResult(null);setCrossResult(null);}}/>
                <div style={{position:"absolute",right:18,top:"50%",transform:"translateY(-50%)",fontSize:13,color:PK.textMuted}}>{title.length}æ–‡å­—</div>
              </div>
              {title.trim()&&(<button onClick={analyzeTitle} disabled={loadingTitle} style={{...btn,background:loadingTitle?"rgba(224,120,32,0.3)":"linear-gradient(135deg,#e07820,#c06010)",cursor:loadingTitle?"not-allowed":"pointer",boxShadow:loadingTitle?"none":"0 4px 20px rgba(224,120,32,0.2)"}}>{loadingTitle?<span style={{animation:"pulse 1.5s infinite"}}>åˆ†æä¸­...</span>:"ã‚¿ã‚¤ãƒˆãƒ«ã‚’åˆ†æã™ã‚‹"}</button>)}
              {titleResult&&<div style={{marginTop:28}}><ResultCard result={titleResult} type="title"/></div>}
            </section>

            {/* 03 SmartNews PVæ•° */}
            <section style={{marginBottom:48}}>
              <div style={secLbl}>03 â€” SmartNews PVæ•°ï¼ˆä»»æ„ï¼‰</div>
              <div style={{position:"relative"}}>
                <input type="number" value={pvCount} placeholder="ä¾‹: 12500" style={{...inp,paddingRight:55}} onChange={e=>{setPvCount(e.target.value);setCrossResult(null);}}/>
                <div style={{position:"absolute",right:18,top:"50%",transform:"translateY(-50%)",fontSize:14,color:PK.textMuted,fontWeight:600}}>PV</div>
              </div>
              {pvCount&&Number(pvCount)>0&&(
                <div style={{marginTop:12,fontSize:14,color:PK.textSub,display:"flex",gap:18,flexWrap:"wrap"}}>
                  <span>ğŸ“Š å…¥åŠ›å€¤: <strong style={{color:PK.textMain}}>{Number(pvCount).toLocaleString()} PV</strong></span>
                  <span style={{color:Number(pvCount)>=100000?"#e890b8":Number(pvCount)>=20000?"#fab0d6":Number(pvCount)>=5000?"#e07820":"#d03030"}}>
                    {Number(pvCount)>=100000?"ğŸ’ ãƒ¡ã‚¬ãƒ’ãƒƒãƒˆæ°´æº–":Number(pvCount)>=50000?"ğŸ”¥ ç‰¹å¤§ãƒ’ãƒƒãƒˆæ°´æº–":Number(pvCount)>=20000?"ğŸ”¥ å¤§ãƒ’ãƒƒãƒˆæ°´æº–":Number(pvCount)>=10000?"âœ¨ å¥½æˆç¸¾æ°´æº–":Number(pvCount)>=5000?"ğŸ“ˆ å¹³å‡æ°´æº–":Number(pvCount)>=2000?"ğŸ“‰ ã‚„ã‚„ä½èª¿":"âš ï¸ ã‹ãªã‚Šä½èª¿"}
                  </span>
                </div>
              )}
            </section>

            {/* 04 ç·åˆã‚¯ãƒ­ã‚¹åˆ†æ */}
            <section style={{marginBottom:48}}>
              <div style={secLbl}>04 â€” ç·åˆã‚¯ãƒ­ã‚¹åˆ†æ</div>
              {!canCross&&(
                <div style={{padding:28,borderRadius:16,border:"2px dashed rgba(250,176,214,0.35)",textAlign:"center",background:"#fffbfd"}}>
                  <div style={{fontSize:15,color:PK.textMuted,lineHeight:1.8}}>ä»¥ä¸‹ã®3ã¤ãŒæƒã†ã¨ç·åˆåˆ†æã‚’å®Ÿè¡Œã§ãã¾ã™</div>
                  <div style={{display:"flex",justifyContent:"center",gap:24,marginTop:18,flexWrap:"wrap"}}>
                    {[{done:!!imageResult,label:"ç”»åƒåˆ†æ"},{done:!!titleResult,label:"ã‚¿ã‚¤ãƒˆãƒ«åˆ†æ"},{done:pvCount&&Number(pvCount)>0,label:"PVæ•°å…¥åŠ›"}].map(item=>(
                      <div key={item.label} style={{display:"flex",alignItems:"center",gap:10,padding:"10px 18px",borderRadius:10,background:item.done?"rgba(250,176,214,0.06)":"#fff",border:`1px solid ${item.done?"rgba(250,176,214,0.25)":"rgba(250,176,214,0.1)"}`}}>
                        <span style={{fontSize:16}}>{item.done?"ğŸŒ¸":"â¬œ"}</span>
                        <span style={{fontSize:14,color:item.done?PK.primary:PK.textMuted,fontWeight:600}}>{item.label}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
              {canCross&&(<button onClick={analyzeCross} disabled={loadingCross} style={{...btn,marginTop:0,background:loadingCross?"rgba(147,51,234,0.3)":"linear-gradient(135deg,#9333ea,#7c3aed)",cursor:loadingCross?"not-allowed":"pointer",fontSize:17,padding:"18px 0",boxShadow:loadingCross?"none":"0 4px 24px rgba(147,51,234,0.2)"}}>{loadingCross?<span style={{animation:"pulse 1.5s infinite"}}>ç·åˆåˆ†æä¸­...</span>:"ğŸ”¬ ç”»åƒ Ã— ã‚¿ã‚¤ãƒˆãƒ« Ã— PV ç·åˆåˆ†æã‚’å®Ÿè¡Œ"}</button>)}
              {crossResult&&<div style={{marginTop:28}}><CrossAnalysisCard result={crossResult} pv={pvCount}/></div>}
            </section>

            {error&&(<div style={{marginTop:28,padding:18,borderRadius:12,background:"rgba(208,48,48,0.06)",border:"1px solid rgba(208,48,48,0.15)",color:"#d03030",fontSize:15}}>{error}</div>)}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
